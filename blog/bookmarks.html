---
layout: default
title: ì €ì¥í•œ ì—ì„¸ì´
permalink: /bookmarks/
---

<div class="bookmarks-page">
  <div class="hero">
    <h1 class="hero-title">ì €ì¥í•œ ì—ì„¸ì´</h1>
    <p class="hero-subtitle">ë¶ë§ˆí¬í•œ ì—ì„¸ì´ë“¤ì„ ëª¨ì•„ì„œ í™•ì¸í•˜ì„¸ìš”</p>
  </div>

  <div id="bookmarks-empty" class="empty-state" style="display: none;">
    <div class="empty-icon">ğŸ”–</div>
    <h2>ì €ì¥í•œ ì—ì„¸ì´ê°€ ì—†ìŠµë‹ˆë‹¤</h2>
    <p>ê´€ì‹¬ìˆëŠ” ì—ì„¸ì´ë¥¼ ë¶ë§ˆí¬í•˜ê³  ë‚˜ì¤‘ì— ë‹¤ì‹œ ì½ì–´ë³´ì„¸ìš”.</p>
    <a href="{{ '/' | relative_url }}" class="btn-primary">ì—ì„¸ì´ ë‘˜ëŸ¬ë³´ê¸°</a>
  </div>

  <div id="bookmarks-content" class="bookmarks-content" style="display: none;">
    <div class="bookmarks-header">
      <p class="bookmarks-count">ì´ <strong id="bookmark-count">0</strong>ê°œì˜ ì—ì„¸ì´</p>
      <button id="clear-all-btn" class="btn-secondary">ì „ì²´ ì‚­ì œ</button>
    </div>

    <div class="essays-grid" id="bookmarks-list">
      <!-- Bookmarked essays will be inserted here -->
    </div>
  </div>
</div>

<script>
  (function loadBookmarks() {
    const storageKey = 'agora-bookmarks';
    const emptyState = document.getElementById('bookmarks-empty');
    const content = document.getElementById('bookmarks-content');
    const list = document.getElementById('bookmarks-list');
    const countEl = document.getElementById('bookmark-count');
    const clearBtn = document.getElementById('clear-all-btn');

    function getBookmarks() {
      try {
        return JSON.parse(localStorage.getItem(storageKey)) || [];
      } catch {
        return [];
      }
    }

    function saveBookmarks(bookmarks) {
      localStorage.setItem(storageKey, JSON.stringify(bookmarks));
    }

    function removeBookmark(path) {
      let bookmarks = getBookmarks();
      bookmarks = bookmarks.filter(b => b.path !== path);
      saveBookmarks(bookmarks);
      renderBookmarks();
    }

    function clearAllBookmarks() {
      if (confirm('ëª¨ë“  ë¶ë§ˆí¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        localStorage.removeItem(storageKey);
        renderBookmarks();
      }
    }

    function renderBookmarks() {
      const bookmarks = getBookmarks();

      if (bookmarks.length === 0) {
        emptyState.style.display = 'block';
        content.style.display = 'none';
        return;
      }

      emptyState.style.display = 'none';
      content.style.display = 'block';
      countEl.textContent = bookmarks.length;

      // Sort by most recent first
      bookmarks.sort((a, b) => b.timestamp - a.timestamp);

      list.innerHTML = bookmarks.map(bookmark => {
        // Extract slug from path for constructing URL
        const slug = bookmark.path.split('/').filter(Boolean).pop();

        return `
          <article class="essay-card bookmarked-card">
            <h3 class="essay-card-title">
              <span class="bookmark-marker" title="ë¶ë§ˆí¬ë¨">ğŸ”–</span>
              <a href="${bookmark.path}">${bookmark.title}</a>
            </h3>
            <div class="bookmark-actions">
              <span class="bookmark-date">${formatDate(bookmark.timestamp)}</span>
              <button class="remove-bookmark-btn" data-path="${bookmark.path}">ì‚­ì œ</button>
            </div>
          </article>
        `;
      }).join('');

      // Attach event listeners
      list.querySelectorAll('.remove-bookmark-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const path = e.target.dataset.path;
          removeBookmark(path);
        });
      });
    }

    function formatDate(timestamp) {
      const date = new Date(timestamp);
      const now = new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMs / 3600000);
      const diffDays = Math.floor(diffMs / 86400000);

      if (diffMins < 1) return 'ë°©ê¸ˆ ì „';
      if (diffMins < 60) return `${diffMins}ë¶„ ì „`;
      if (diffHours < 24) return `${diffHours}ì‹œê°„ ì „`;
      if (diffDays < 7) return `${diffDays}ì¼ ì „`;

      return date.toLocaleDateString('ko-KR', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    }

    clearBtn.addEventListener('click', clearAllBookmarks);
    renderBookmarks();

    // Listen for storage changes from other tabs
    window.addEventListener('storage', (e) => {
      if (e.key === storageKey) {
        renderBookmarks();
      }
    });
  })();
</script>
